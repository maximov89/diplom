
## Дипломная работа по курсу «PHP/SQL: back-end разработка и базы данных

Разработать типовой сервис вопросов и ответов. Должна быть реализована клиентская часть сервиса и интерфейс администратора.<br>

1. Описание клиентской части<br>
Пользователи могут просматривать категории, вопросы и ответы.<br>
Любой пользователь может задать вопрос, указав своё имя, адрес электронной почты, выбрав категорию и написав текст вопроса.<br>
Вопросы без ответов не публикуются на сайте.<br>

2. Вход в интерфейс администратора.<br>
Для попадания в интерфейс администратора нужно ввести логин и пароль.<br>
По умолчанию создан единственный администратор с логином admin и паролем admin.<br>

3.Возможности в интерфейсе администратора.<br>
Просматривать список администраторов.<br>
Создавать новых администраторов.<br>
Изменять пароли существующих администраторов.<br>
Удалять существующих администраторов.<br>
Просматривать список тем. По каждой теме в списке видно сколько всего вопросов в ней, сколько опубликовано, сколько без ответов.<br>
Создавать новые темы.<br>
Удалять существующие темы и все вопросы в них.<br>
Просматривать вопросы в каждой теме. По каждому вопросу видно дату создания, статус (ожидает ответа / опубликован / скрыт).
Удалять любой вопрос из темы.<br>
Скрывать опубликованные вопросы.<br>
Публиковать скрытые вопросы.<br>
Редактировать автора, текст вопроса и текст ответа.<br>
Перемещать вопрос из одной темы в другую.<br>
Добавлять ответ на вопрос с публикацией на сайте, либо со скрытием вопроса.<br>
Видеть список всех вопросов без ответа во всех темах в порядке их добавления. И иметь возможность их редактировать и удалять.<br>

4.Интерфейс.<br>
За основу пользовательского интерфейса можно взять этот шаблон (демо).<br>
Для построения интерфейса системы администрирования можно использовать фреймворки Bootstrap или Materialize.<br>
Все интерфейсные решения — на ваше усмотрения. Делайте как проще. Но основной приоритет — простота использования неподготовленным пользователем.<br>

5.Требования к организации системы.<br>
Система должна быть реализована на PHP.<br>
Использована MVC архитектура.<br>
Все компоненты должны быть реализованы с использованием ООП.<br>
В качестве шаблонизатора использовать Twig. Если вы предпочитаете другой шаблонизатор — выбор нужно будет обосновать.<br>
Данные администраторов, тем, вопросов и ответов должны хранится в СУБД MySQL.<br>
Система при работе не должна вызывать исключений и ошибок, в том числе уровня E_WARNING и E_STRICT.<br>

6.Что необходимо предоставить по проекту.<br>
Описание системы. Ссылка на Google-документ, в котором описано как устроена ваша система и нарисована UML-схема базы данных.<br>
Инструкции по установке и первому запуску. Файл README.md или README.html в папке проекта.<br>
Структуру базы данных в файле faq.sql.<br>
Все необходимые файлы для работы системы, а так же README.md и faq.sql должны быть доступны в репозитории на BitBucket или GitHub, или в рабочем пространстве в Cloud9. Нужно предоставить доступ к этим системам.<br>
Актуальная версия проекта должен быть опубликован на university.netology.ru и необходимо предоставить ссылку.<br>

7.Дополнительные задачи.<br>
Действия администраторов должны журналироваться в файл. Примерно в таком виде:<br><br>
[2016-05-01 12:00:00] admin создал тему "Вопросы по PHP" (12)<br>
[2016-05-01 13:00:00] admin удалил вопрос (99) из темы "Вопросы по PHP" (12)<br>
[2016-05-01 13:07:00] admin обновил вопрос (100) из темы "Вопросы по PHP" (12)<br>
[2016-05-01 13:10:00] admin опубликовал вопрос (100) из темы "Вопросы по PHP" (12)<br>
Реализовать блокировку вопросов по ключевым словам. Администратор ведет справочник запрещенных слов. И если в вопросе встречается запрещенное слово, то вопрос помечается как заблокированный. Такие вопросы видно только в отдельном списке «заблокированные вопросы». Там их можно просмотреть и разблокировать. Должно быть видно по каким словам вопрос был заблокирован.<br>
Реализовать Телеграм-бота, которому можно задать вопрос. Вопрос добавляется в общий список. Когда администратор опубликует ответ на вопрос, то бот должен так же отправить ответ сообщением в Телеграм пользователю, который его задал.<br>

## Работа сервиса «Вопрос – ответ».
Заходя на сайт, пользователь видит список вопросов, отсортированный по группам и дате добавления (сначала новые), пользователь может «пролистнуть» список до определенной темы, кликнув на соответствующую группу с лева.<br>
Кликнув по заголовку вопроса, можно посмотреть описание вопроса, а так же ответы на этот вопрос, там же можно ответить на этот вопрос, кликнув по кнопке «Ответить».<br>
Пользователь может ответить на вопрос, авторизовавшись или зарегистрировавшись на сайте.<br>
Пользователь может добавить новый вопрос, который попадет на модерацию к администратору / модератору системы, после подтверждения, вопрос будет опубликован на главной странице системы, так же пользователь сможет просмотреть список своих вопросов и ответов по ним в личном кабинете, там же пользователь может посмотреть состояние всех своих вопросов (подтвержден, отклонен, на модерации).<br>
По умолчанию сортировка вопросов в личном кабинете идет от более поздних к ранним.<br>
Если пользователь не зарегистрирован в системе, ему будет предложено дополнительно ввести имя и email, по которым пользователь будет зарегистрирован и будет сгенерирован пароль, который можно сменить в личном кабинете, кликнув на свое имя с права и выбрать пункт «Изменить пароль».

Так же, если пользователь забыл свой пароль, он может его сбросит, для этого необходимо зайти на форму «авторизации» и нажать на ссылку «забыли пароль» (для корректной работы данной функции, на сервере должна быть настроена работа с почтой), после чего пользователь попадает на форму восстановления пароль, где необходимо ввести свой email. <br>
После чего на email будет выслана инструкция по смене пароля.


Статус вопросов делется на цвета:<br>
<strong>• Зеленый цвет текста </strong> означает что вопрос удачно прошел модерацию и опубликован на сайте.<br>
<strong>• Оранжевый цвет текста </strong> означает что вопрос находится на модерации и еще не проверен администратором / модератором системы.<br>
<strong>• Красный цвет тексты </strong> означает что вопрос не прошел модерацию, был отклонен и не будет опубликован на сайте.<br>

При отклонении вопроса, пользователь может отредактировать вопрос, тему и текст, после чего вопрос повторно попадет на модерацию.<br>
Даже если вопрос ранее был опубликован и пользователь захотел его изменить, вопрос повторно попадет на модерацию.


----------


## Установка системы
Для установки системы сначала необходимо установить PHP Composer<br>
1)	Загрузить установочный пакет:<br>
•	php -r "readfile('https://getcomposer.org/installer');" | php
2)	Загрузить сам Composer<br>
•	php composer.phar require silex/silex ~1.1<br>
После установки Composer необходимо установить зависимости Laravel<br>
•	composer install

После установки всех зависимостей, composer сгенерирует уникальный APP_KEY, который вы можете просмотреть в файле .env (если файл отсутствует его необходимо создать, скопировав .env.example) в корне проекта, если ключ не был сгенерирован, необходимо запустить генерацию ключа в ручную при помощи помощника Artisan.<br>
•	php artisan key:generate <br>
После необходимо создать базу данных. <br>
Для настройки системы необходимо изменить файл .env в корне проекта и отредактировать строки:<br>
•	DB_CONNECTION=mysql    -   тип подключения к БД<br>
•	DB_HOST=127.0.0.1   -   IP-адрес сервера базы данных<br>
•	DB_PORT=3306   -   Порт работы SQL сервера (по умолчанию 3306)<br>
•	DB_DATABASE=dbname    -   Имя базы данных<br>
•	DB_USERNAME=root   -   Имя пользователя БД<br>
•	DB_PASSWORD=root   -   Пароль пользователя БД<br>

После создания БД и настройки файла конфигурации, необходимо запустить миграции, для создания таблиц в базе данных. Для этого используем Laravel помощника Artisan.<br>
•	php artisan migrate <br>
После того как миграции были сделаны, в базе данных должны появиться таблица users, questions, themes, answers. Таблицы migrations, password_resets являются системными.<br>
Для добавления системного пользователя по умолчанию, необходимо запустить «Сиды», делает это так же при помощи помощника Artisan.<br>
•	php artisan db:seed <br>
После выполнения скрипта в базе данных появится пользователь с ролью Администратор с логином admin@local.ru и паролем admin.<br>

При необходимости наполнения тестовыми записями данных, необходимо зайти в phpMyAdmin и импортировать файл faq.sql.<br>
В проект будут загруженные тестовые данные вопросов, ответов, пользователей.

По умолчанию в системе логируется ключевые действия системы (Модерация вопросов, модерация тем, модерация пользователей), файл сохранения логов хранится по адресу <strong>storage\logs\admins.log</strong> .

## Схема БД
![Схема БД](https://raw.githubusercontent.com/vnucka/faq/master/scheme%20db.png)
